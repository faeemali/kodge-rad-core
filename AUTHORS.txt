This code is the work of Faeem Ali (faeem.ali at gmail.com)